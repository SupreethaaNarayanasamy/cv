import tensorflow as tf
import cv2
import numpy as np
from matplotlib import pyplot as plt

# Load two sample images from TensorFlow datasets
data = tf.keras.datasets.cifar10.load_data()
(train_images, _), (_, _) = data

# Take two random images
M1 = train_images[0]
M2 = train_images[1]

# Convert to grayscale for simplicity
M1_gray = cv2.cvtColor(M1, cv2.COLOR_RGB2GRAY)
M2_gray = cv2.cvtColor(M2, cv2.COLOR_RGB2GRAY)

# Compute absolute difference
Out = cv2.absdiff(M1_gray, M2_gray)

# Display the result
plt.figure(figsize=(10,5))
plt.subplot(1,3,1)
plt.title("Image 1")
plt.imshow(M1_gray, cmap='gray')

plt.subplot(1,3,2)
plt.title("Image 2")
plt.imshow(M2_gray, cmap='gray')

plt.subplot(1,3,3)
plt.title("Absolute Difference")
plt.imshow(Out, cmap='gray')

plt.show()
